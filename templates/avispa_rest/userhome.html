{% extends 'base.html' %}

{% block title %}
	My Ring - {{ title }}
{% endblock %}


{% block content %}

<!-- CONTENT HERE -->


<section>
  <div class="container-fluid">
    <div class="row">
      <div class="col-xs-12 text-right">

            
         <img class="img-responsive center-block user-big" src="{% if data.handle_profilepic %}/_images/{{data.handle}}/t150/{{data.handle_profilepic}}_t150.jpg{% else %}/static/images/generic_thumbnail.png{% endif %}" style="float:left; margin-right:10px;" alt="">

        {% if data.handle_actualname %} 
         <h1 class="text-lead fw-300 pull-left"><span class="text-gray">{{data.handle_actualname}}</span><br/><span class="text-lgray pull-left fs-0-6">{{data.handle}}</span></h1><br/>
        {% else %}
         <h1 class="text-lead fw-300 pull-left"><span class="text-gray">{{data.handle}}</span><br/><span class="text-lgray pull-left fs-0-6"></span></h1><br/>
        {% endif %}


        
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12">
        <div class="spa20"></div>
        
      </div>
      
    </div>
  </div>  
</section>



<section>
  <div class="container-fluid">
      <div class="row">
        

        <div class="col-sm-12">

          <div class="rn-box-solo">
              <div class="row">
                
                <div class="col-sm-12">

                <div class="spa20"></div>
                  <div id="usergraph" class="ugp-container">

                  </div>
                  <div class="lead fs-1 text-lgray" id="chisme" style="float:right;"></div>

                  <!-- To use the graph, just load "days" with an array full of numbers, the javascript will adapt to them This is a Work in Progress.. -->

                  <script>
                  days = [20, 0, 0, 125, 0, 50, 80, 55,95, 00, 60, 85,103,20, 15, 30, 65,20, 0, 0, 55,95, 10, 40, 35,70, 85,35, 20, 0, 5,7,0, 0, 2, 0,25, 33, 0, 65,90, 67,32, 60, 0, 5,7,20, 15, 30, 65,30, 50, 80, 55,95, 10, 60, 115,70,20, 15, 30, 65,20, 0, 50, 90,95, 126, 40, 35,70, 85,35, 20, 0, 5,7,0, 1, 2, 0,25, 33, 0, 65,90, 90,32, 60, 0, 5,7];

                  //days = [50, 100, 250, 300, 200, 0, 150];


                 


                  var length = days.length ,
                      min = Math.min.apply(null, days),
                      max = Math.max.apply(null, days),
                      sum = days.reduce( function(total, num){ return total + num }, 0),
                      avg = Math.round(sum / length) ;


                  


                 
                    $("#chisme").append("<span> <strong>Items: </strong>"+ sum +" | </span>");

                   $("#chisme").append("<span> <strong>Upload</strong> Average: "+ avg +" /day | </span>");
                   
                  
                  $("#chisme").append("<span> Record: "+ max +" </span>");

                  

                  var i;
                  for (i = 0; i < days.length; i++) {


                      //1 day more, to avoid problems with zero
                      var d= parseInt(days[i]);
                      var d1= parseInt(days[i]) + 1;

                      var pcent= (d1 * 100) / max;

                      //Setting opacity
                      var opacity= (pcent +20) / 100;


                      //Creating the day inside usergraph
                      


                        if (d != max) { 
                          $("#usergraph").append("<div class='ugp' style='height: "+pcent + "%; opacity:"+ opacity + ";' data-toggle='tooltip' title=' " + d +"'></div>");
                            
                        }else{

                          $("#usergraph").append("<div class='ugp ugp2' style='height: "+pcent + "%; opacity:"+ opacity + "; ' data-toggle='tooltip' title='Record: " + d +"'></div>");

                        }  

                  }

                  //defining the witdth of div (amount of items / 100%)
                  var divisions = 100 / length +"%";
                  $('.ugp').css('width', divisions);

                  
                  


                  </script>








                </div>
              </div>
          </div>
          <div class="spa10"></div>
        </div>
        
      </div>

      <div class="row">
        <div class="col-sm-6">
          <!-- BOX CONTENT -->
          <div class="rn-box-title">

              <a href="/{{data.handle}}/_collections" type="button" class="btn btn-info btn-xs pull-right">
              see all</a> 

              <strong>
                  <h4>Ring Collections</h4>
              </strong>


            </div>
          <div class="rn-box-solo">
              <table class="table table-striped table-condensed" cellpadding="0" cellspacing="0">
              
                  {% for collection in data.collections.collectionlist %}  
                    {% if collection.valid %}
                      {{ ui.collection(data.handle,collection.collectionname,6,1,'1 day ago') }}
                      <tr>
                        <td></td>
                        <td colspan="2">
                          <table class="table table-striped">
                            {% for ring in collection.rings %}  
                              {{ ui.panel_collections(data.handle,collection.collectionname,ring.ringname, '#fce121', ring.count , '85', '',data.user_authorizations) }}
                            {% endfor %}
                              
                          </table>
                        </td>
                        
                      </tr>
                    {% endif %}
                  {% endfor %}

                       
              </table>  

          </div> 
          <a href="/{{data.handle}}/_collections?rq=post">New Collection</a>
          <br/>





          <br/><br/>
        </div><!-- close  --> 

        <div class="col-sm-6">
          <div class="rn-box-title">
              <a href="/{{data.handle}}" type="button" class="btn btn-info btn-xs pull-right">
              see all</a> 
              
                  My Rings
              
          </div>
          <div class="rn-box-solo">

          <table class="table table-striped table-condensed">
          {% for ring in data.rings.ringlist %}

            {{ ui.panel_rings(ring.ringname, ring.ringorigin, data.handle, '#924ea0', ring.count, '36', '',data.handle+'/'+ring.ringname,data.user_authorizations) }}

          {% endfor %}

          </table>                  
                            
          </div> 
          <a href="/{{data.handle}}?rq=post&n=10">New Ring</a>
          
        </div><!-- close 2 --> 

        <div class="col-sm-6">
          <div class="rn-box-title"> 
              Organizations 
          </div>
          <div class="rn-box-solo">
            <table class="table table-striped table-condensed">
            {% for organization in data.organizations %}
                <div class="col-xs-12 text-right">
                    
                    <h4 class="text-lead fw-300 pull-left">
                        <a href="/{{organization}}/_home">{{organization}}</a>
                        <span class="text-gray"></span>
   
                    </h4>
                    <br/>        
                </div>
            {% endfor %}
            </table>                                       
          </div> 

          <a href="/_orgregister">New Organization</a>
          <br/><br/><br/>
          

        </div><!-- close 2 --> 


                <!-- COLUMN 1 -->
        <!-- COLUMN 1 -->           
    </div>
  </div>
</section>

    
	
{% endblock %}

