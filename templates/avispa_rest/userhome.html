{% extends 'base.html' %}

{% block title %}
  My Ring - {{ title }}
{% endblock %}


{% block content %}

<!-- CONTENT HERE -->


<section>
  <div class="container">
    <div class="row">
      <div class="col-xs-12 text-right">

            
         <img class="img-responsive center-block user-big" src="{% if data.handle_profilepic %}/_images/{{data.handle}}/t150/{{data.handle_profilepic}}_t150.jpg{% else %}/static/images/generic_thumbnail.png{% endif %}" style="float:left; margin-right:10px;" alt="">

        {% if data.handle_actualname %} 
         <h1 class="text-lead fw-300 pull-left"><span class="text-gray">{{data.handle_actualname}}</span><br/><span class="text-lgray pull-left fs-0-6">{{data.handle}}</span></h1><br/>
        {% else %}
         <h1 class="text-lead fw-300 pull-left"><span class="text-gray">{{data.handle}}</span><br/><span class="text-lgray pull-left fs-0-6"></span></h1><br/>
        {% endif %}


        <a class="btn btn-large btn-vader" href="javascript:void(0);" onclick="startIntro().setOption('showProgress', true);" style="text-align:center;"><i class="fa fa-play-circle fa-3x"></i> <br/>Start Tour </a>

        
      </div>
    </div>
    <div class="row">
      <div class="col-xs-12">
        <div class="spa20"></div>
        
      </div>
      
    </div>
  </div>  
</section>



<section>
  <div class="container-fluid">
      <div class="row">
        

        <div class="col-sm-12 alpha omega">

          <div class="rn-box-solo" >
              <div class="row">
                
                <div class="col-sm-12" id="step1">

                <div class="spa20"></div>

                  <div id="usergraph" class="ugp-container">

                  </div>


                  <div class="lead fs-1 text-lgray" id="chisme" style="float:right;">
                    
                    <a href="/" type="button" class="btn btn-default btn-xs pull-right margin-x-10" id="t002_4"><i class="fa fa-question-circle"></i></a>
                  </div>

                  <div style="position:absolute; left:10px;">
                   
                  
                  <a class="btn btn-default btn-warning" href="javascript:void(0);" onclick="t002();" style="text-align:center;">Take Graph Tour &nbsp; &nbsp;<i class="fa fa-play-circle fa-2x"></i> </a>

                  </div>
                    
                  </div>

                  <!-- To use the graph, just load "days" with an array full of numbers, the javascript will adapt to them This is a Work in Progress.. -->

                  <script>
                  days = [20, 0, 0, 40, 0, 50, 30, 25,15, 00, 20, 35,13,20, 15, 0, 0,20, 0, 0, 15,15, 10, 40, 35,70, 85,35, 20, 0, 5,7,0, 0, 2, 0,25, 33, 0, 65,90, 67,32, 60, 0, 5,7,20, 15, 30, 65,30, 50, 80, 55,95, 10, 60, 115,70,20, 15, 30, 65,20, 0, 50, 90,95, 126, 40, 35,70, 85,35, 20, 0, 5,7,0, 1, 2, 0,25, 33, 0, 65,90, 90,32, 60, 0, 5,7];

                  //days = [50, 100, 250, 300, 200, 0, 150];



                  var length = days.length ,
                      min = Math.min.apply(null, days),
                      max = Math.max.apply(null, days),
                      sum = days.reduce( function(total, num){ return total + num }, 0),
                      avg = Math.round(sum / length) ;


                 
                    $("#chisme").append("<span> <strong>Items: </strong>"+ sum +" | </span>");

                   $("#chisme").append("<span> <strong>Upload</strong> Average: "+ avg +" /day | </span>");
                   
                  
                  $("#chisme").append("<span> Record: "+ max +" </span>");

                  

                  var i;
                  for (i = 0; i < days.length; i++) {


                      //1 day more, to avoid problems with zero
                      var d= parseInt(days[i]);
                      var d1= parseInt(days[i]) + 1;

                      var pcent= (d1 * 100) / max;

                      //Setting opacity
                      var opacity= (pcent +20) / 100;


                      //Creating the day inside usergraph
                      


                        if (d != max) { 
                          $("#usergraph").append("<div class='ugp' style='height: "+pcent + "%; opacity:"+ opacity + ";' data-toggle='tooltip' title=' " + d +"'></div>");
                            
                        }else{

                          $("#usergraph").append("<div class='ugp ugp2' style='height: "+pcent + "%; opacity:"+ opacity + "; ' data-toggle='tooltip' title='Record: " + d +" <br/> Jan 23, 2015' id='t002_2'></div>");

                        }  

                  }

                  //defining the witdth of div (amount of items / 100%)
                  var divisions = 100 / length +"%";
                  $('.ugp').css('width', divisions);


                  </script>

                </div>
              </div>
          </div>
          <div class="spa10"></div>
        </div>
        
      </div>

      <div class="row">
        

        <div class="col-sm-6 omega" >
          <div id="step2"> <!-- This Div is for the tour -->
            <div class="rn-box-title">

                <a href="/" type="button" class="btn btn-default btn-xs pull-right">
                <i class="fa fa-question-circle"></i></a>
                {% if 'get_a' in data.user_authorizations %}
                  <a href="/{{data.handle}}" type="button" class="btn btn-info btn-xs pull-right">
                  see all</a> 
                {%endif%}
                
                {% if 'post_a' in data.user_authorizations %}
                <a href="/{{data.handle}}?rq=post&n=10" class="btn btn-success btn-xs pull-right"><i class="fa fa-plus"></i></a>
                {%endif%}

                 My Rings
                
            </div>
            <div class="rn-box-solo">

            <table class="table table-striped table-condensed">

            {% for ring in data.rings.ringlist %}

              {{ ui.panel_rings(ring.ringname, ring.ringorigin, data.handle, '#924ea0', ring.count, '36', '',data.handle+'/'+ring.ringname,data.user_authorizations) }}

            {% endfor %}

            {% if 'post_a' in data.user_authorizations %}
            <tr>
              <td colspan="2" align="right" style="vertical-align:top;">
                {{ ui.icon_med('',"#28B62C") }}
              </td>
              <td  style="vertical-align:middle; align:center; ">
                  <a href="/{{data.handle}}?rq=post&n=10" class="btn btn-default btn-success">
                    <i class="fa fa-plus"></i> &nbsp; Create New Ring
                  </a>        
              </td>
              <td  style="vertical-align:middle; align:center; ">
              </td>
            </tr>
            {%endif%}

            </table>                  
                              
            </div>
          </div> 

          <!-- ORGANIZATIONS -->


          <div id="step4">
            <div class="rn-box-title"> 
                <a href="/_orgregister" class="btn btn-success btn-xs pull-right"><i class="fa fa-plus"></i></a>
                Organizations       
            </div>
            <div class="rn-box-solo">
              <table class="table table-striped table-condensed">
              {% for organization in data.organizations %}
                  <div class="col-xs-12 text-right">
                      <h4 class="text-lead fw-300 pull-left">
                          <a href="/{{organization}}/_home">{{organization}}</a>
                          <span class="text-gray"></span>
                      </h4>
                      <br/>        
                  </div>
              {% endfor %}
              </table>                                       
            </div>
          </div>


          
          
        </div><!-- close 6 -->

        <div class="col-sm-6 alpha">
          <!-- BOX CONTENT -->
          <div id="step3">
            <div class="rn-box-title">

                <a href="/" type="button" class="btn btn-default btn-xs pull-right">
                <i class="fa fa-question-circle"></i></a>
                {% if 'get_a_x' in data.user_authorizations %}
                  <a href="/{{data.handle}}/_collections" type="button" class="btn btn-warning btn-xs pull-right">
                  settings</a>
                {%endif%}

                {% if 'post_a_x' in data.user_authorizations %}
                <a href="/{{data.handle}}/_collections?rq=post" class="btn btn-success btn-xs pull-right"><i class="fa fa-plus"></i></a>
                {%endif%}

                
                Rings
                
            </div>
            <div class="rn-box-solo">
                <table class="table table-striped table-condensed" cellpadding="0" cellspacing="0">
                
                    {% for collection in data.collections.collectionlist %}  
                      {% if collection.valid %}
                        {{ ui.collection(data.handle,collection.collectionname,6,1,'1 day ago') }}
                        <tr>
                          <td></td>
                          <td colspan="2">
                            <table class="table table-striped">
                              {% for ring in collection.rings %}  
                                {{ ui.panel_collections(data.handle,collection.collectionname,ring.ringname, '#fce121', ring.count , '85', '',data.user_authorizations) }}
                              {% endfor %}
                                
                            </table>
                          </td>
                        </tr>
                      {% endif %}
                    {% endfor %}
                    
        
                </table>  
            </div>
          </div>   

          
        </div><!-- close  -->  

        <div class="col-sm-6" >
          

        </div>

          

        </div><!-- close 2 --> 


                <!-- COLUMN 1 -->
        <!-- COLUMN 1 -->           
    </div>
  </div>
</section>

 
 <script type="text/javascript" src="{{ url_for('static',filename='js/intro.js') }}"></script>
     <script type="text/javascript">
      function startIntro(){
        var intro = introJs();
          intro.setOptions({
            steps: [
              {
                element: '#step1',
                intro: "<table><tr><td><h4 class='fs-9'>1 </h4></td><td><h3 class='lh-1'>This is your <br/><strong>User Graph</strong></h3></td></tr><tr><td colspan='2'><p>All your activity goes here</p></td></tr></table>"
              },
              {
                element: '#step2',
                intro: "<table><tr><td><h4 class='fs-9'>2 </h4></td><td><h3 class='lh-1'>Create your <br/><strong>first Ring</strong></h3></td></tr><tr><td colspan='2'><p>Ring is where you put all your data</p></td></tr></table>",
                position: 'right'
              },
              {
                element: '#step3',
                intro: "<table><tr><td><h4 class='fs-9'>3 </h4></td><td><h3 class='lh-1'>Create Rings<br/><strong>Collections</strong></h3></td></tr><tr><td colspan='2'><p>A Ring Collection contains a group of related Rings.</p></td></tr></table>",
                position: 'left'
              },
              {
                element: '#step4',
                intro: "<table><tr><td><h4 class='fs-9'>4 </h4></td><td><h3 class='lh-1'>Join or create an<br/><strong>Organization</strong></h3></td></tr><tr><td colspan='2'><p>An Organization is how various users contribute in  MyRing.</p></td></tr></table>",
                position: 'top'
              }
            ]
          });

          intro.start();
      }

      function t002(){
        var intro = introJs();
          intro.setOptions({
            steps: [
              {
                element: '#step1',
                intro: "<h3 class='lh-1'>This is the user graph</h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",position: 'bottom'
              },
              {
                element: '#usergraph',
                intro: "<h3 class='lh-1'>This graph measures your activity in MyRing</h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
                position: 'bottom'
              },
              {
                element: '#t002_2',
                intro: "<h3 class='lh-1'>Each strip represents a day of activity</h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
                position: 'right'
              },
              {
                element: '#chisme',
                intro: "<h3 class='lh-1'>Your hard numbers</h3><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.",
                position: 'left'
              },
              {
                element: '#t002_4',
                intro: "<h3 class='lh-1'>Help</h3><p>This button activates this modal. In case you have further questions please visit our <a href='/'>knowledge base</a> or contact us at myring.io",
                position: 'left'
              }
              
            ]
          });

          intro.start();
      }
    </script>   
  
{% endblock %}

