{% extends 'avispa_rest/tabs.html' %}

{% block title %} {% endblock %}
{% block findme %} post_rq_a{% endblock %}

{% block crumbs %}

<li class="active">New Ring</li>

{% endblock %}

{% block footfunctions %}


    {% set numfields = request.args.get('n')|int %} 
    {% for f in range( 1, numfields+1) %}

          <script type="text/javascript">
              var allbt= "bt-1 bt-2 bt-3 bt-4 bt-5 bt-6 bt-7";
              var allbb= "bc-1 bc-2 bc-3 bc-4 bc-5 bc-6 bc-7 ";

                $(document).ready(function(){

                  $(".treset{{ f }}").click(function(){
                    var layer = $(this).attr('layer');
                    $("#tagged{{ f }}").removeClass(allbt).addClass("bt-"+layer);
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).removeClass(allbt).addClass("bt-"+layer);                   
                    $("#tagvalue_{{ f}}").attr("value",layer);
                  }); 
                  
                  $("#tag1-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-1");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-1");
                    $("#tagvalue_{{ f }}").attr("value","1");
                  }); 
                  $("#tag2-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-2");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-2");
                    $("#tagvalue_{{ f }}").attr("value","2");
                  }); 
                  $("#tag3-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-3");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-3");
                    $("#tagvalue_{{ f }}").attr("value","3");
                  }); 
                  $("#tag4-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-4");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-4");
                    $("#tagvalue_{{ f }}").attr("value","4");
                  }); 
                  $("#tag5-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-5");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-5");
                    $("#tagvalue_{{ f }}").attr("value","5");
                  }); 
                  $("#tag6-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-6");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-6");
                    $("#tagvalue_{{ f }}").attr("value","6");
                  }); 
                  $("#tag7-{{ f }}").click(function(){
                    $(".tagged{{ f }}").removeClass(allbt).addClass("bt-7");
                    $(".treset{{ f }}").removeClass(allbt);
                    $(this).addClass("bt-7");
                    $("#tagvalue_{{ f }}").attr("value","7");
                  }); 
                   
                });
          </script>

    {% endfor %}




<script>

//PORTLET
$(function() {
  $(".portlet-content").hide();
  $( "#columnfields" ).sortable({
  // connectWith: ".columnfields",
  handle: ".handler",
  cancel: ".portlet-toggle",
  placeholder: "portlet-placeholder ui-corner-all ui-sort-position",
  opacity:0.7,
  cursor: "move",
  axis: 'y',
  stop: function(event,ui){
    var pOrder = $(this).sortable('toArray').toString();
    $(".exit").prepend( pOrder);
  }


  });
  $( ".portlet" )

    .addClass( "ui-widget ui-widget-content ui-helper-clearfix ui-corner-all" )
    .find( ".portlet-header" )
    .addClass( "ui-widget-header ui-corner-all" );

  $(".tog")
    .prepend( "<i class='fa fa-plus-circle portlet-toggle'></i>");
  $( ".portlet-toggle" ).click(function() {
    var icon = $( this );
    icon.toggleClass( "fa-plus-circle fa-minus-circle" );
    icon.closest( ".portlet" ).find( ".portlet-content" ).toggle();
  });

  //$(".tog").prepend( "<span class='label label-warning'>W " + ui.index()+ "</span>");
  $(".tog").prepend( "<span class='label label-warning'>W</span>");


});


</script>



{%endblock%}

{% block tabcontent %}


<!-- START NEW CONTENT --> 



<div class="row">
    <div class="col-sm-8 alpha omega">
        <div class="alert  alert-success alert-top" style="height:60px;">
            <span class="fs-1-5"><i class="fa fa-info-circle"></i> Create a New Ring  {%if data.collection %}in <strong>'{{data.collection|upper}}'</strong>{%endif%}</span>
            <p>Please complete the following steps.</p>
        </div>

    </div>
    <div class="col-sm-4 alpha omega text-right">
        <div class="alert  bg-gray alert-top" style="height:60px;">
            <p class="fs-1">or, use an existing Ring : 
                <button type="button" class="btn btn-vader btn-sm" data-toggle="modal" data-target="#forkModal">
                    <i class="fa fa-code-fork fa-2x fc-a"></i>
                </button>
            </p>
        </div>

    </div>
</div>

         
<div class="row bg-g">
    <div class="col-sm-3">
        <form class="form-horizontal" role="form" action="/{{ data.handle }}{%if data.collection %}/_collections/{{data.collection}}{%endif%}" method="POST">
        <h2 class="fs-4">1</h2> 
        <p class=" text-s1 text-lgray fs-1-5">Ring Name and Description</p>

    </div>
    <div class="col-sm-9">
        <div class="spa40">
               

                {%if data.collection %}
                <input type="hidden" name="collection" value="{{data.collection}}">
                {%endif%}
                
                <div class="input-group input-group-sm">
                  <span class="input-group-addon" id="sizing-addon1">Ring Name</span>
                  <input name="RingName" type="text" class="form-control" id="RingName" placeholder="The name of the new Ring">
                </div>
                <!-- <div class="input-group input-group-sm">
                  <span class="input-group-addon" id="sizing-addon1">label</span>
                  <input name="RingLabel" type="text" class="form-control" id="RingLabel" placeholder="The Label for this ring">
                </div> -->
                <div class="input-group input-group-sm">
                  <span class="input-group-addon" id="sizing-addon1">Description</span>
                  <textarea name="RingDescription" class="form-control" rows="10" placeholder="Please describe the Ring" style="height:100px;" ></textarea>
                </div>

                
                  <!-- <label for="RingVersion" class="col-sm-2 control-label">ring:version</label>
                  <div class="col-sm-10">
                    <input name="RingVersion" type="text" class="form-control" id="RingVersion" placeholder="if this ring is new it must be version 1">
                  </div>
                  <label for="RingURI" class="col-sm-2 control-label">ring:URI</label>
                  <div class="col-sm-10">
                    <input name="RingURI" type="text" class="form-control" id="RingURI" placeholder="URI that will be used to refer to this specific ring">
                  </div>
                  <label for="inputEmail3" class="col-sm-2 control-label">ring:build</label>
                  <div class="col-sm-10">
                    <input name="RingBuild" type="text" class="form-control" id="RingBuild" placeholder="">
                  </div> -->
                
        </div>
    </div>
</div>
 
        <div class="row bg-g">
          <div class="col-sm-12">
            <hr/>
          </div>          
        </div>


        <div class="row bg-g">
          <div class="col-sm-3">
            <h2 class="fs-4 ">2</h2> <p class="text-s1 text-lgray fs-1-5">Ring fields</p>
              
          </div>
          <div class="col-sm-9">
            
  
              {% set numfields = request.args.get('n')|int %}

              <div id="columnfields"> <!-- A. START DRAG AREA -->
              {% for FieldOrder in range( 1, numfields+1) %}


                {{ ui.portlet(FieldOrder,3,True,FieldName,'text',FieldCardinality,'','',FieldSemantic,FieldLabel) }}
                



              {% endfor %}
              </div> <!-- A. CLOSE COLUMN  -->

            
          </div><!-- CLOSE COLSM10 -->
        </div><!-- CLOSE ROW -->

        <div class="row bg-g">
          <div class="col-sm-12">
            <hr/>
          </div>          
        </div>

        <div class="row bg-g">
          <div class="col-sm-3">
            
            <span class="fs-4">3</span> <p class="text-s1 text-lgray fs-1-5">Save</p>
          </div>
          <div class="col-sm-9">
            <button type="submit" class="btn btn-primary">Save</button>
            <a href="/{{ data.handle }}" type="submit" class="btn btn-default">Leave without saving anything</a> 

          </div>
        </div>

    </form>





<!-- ForkModal -->
<div class="modal fade" id="forkModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel"><i class="fa fa-code-fork fa-2x"></i> Fork existing Ring</h4>
      </div>
      <form id="post_rq_a" action="/{{ data.handle }}{%if data.collection %}/_collections/{{data.collection}}{%endif%}" method="POST" >
      <div class="modal-body">       
           Load Parent Ring from this URL: <input name="ringurl" class="form-control" type="text">
      </div>
      <div class="modal-footer">
        <input name="submit" value="load and save" type="submit" class="btn btn-success">       
      </div>
      </form>
    </div>
  </div>
  
</div>
<div class="spa50"></div>



{% endblock %}


{% block modals %}

  {% include 'avispa_rest/helpmodal.html' %}

{% endblock %}


{% block findme %} post_rq_a {% endblock %}

